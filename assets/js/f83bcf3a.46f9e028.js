"use strict";(self.webpackChunkweb3_feedback=self.webpackChunkweb3_feedback||[]).push([[4193],{10819:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"learn/aiagent-quickstart","title":"Build an AI agent","description":"A quickstart guide to building a simple AI agent on Linea.","source":"@site/docs/learn/aiagent-quickstart.mdx","sourceDirName":"learn","slug":"/learn/aiagent-quickstart","permalink":"/web3-feedback/learn/aiagent-quickstart","draft":false,"unlisted":false,"editUrl":"https://github.com/Consensys/doc.linea/tree/main/docs/learn/aiagent-quickstart.mdx","tags":[],"version":"current","lastUpdatedBy":"Joel Willmore","lastUpdatedAt":1746005489000,"frontMatter":{"title":"Build an AI agent","description":"A quickstart guide to building a simple AI agent on Linea.","image":"/img/socialCards/build-an-ai-agent.jpg"},"sidebar":"learnSidebar","next":{"title":"Build a marketplace dapp","permalink":"/web3-feedback/learn/marketplace-dapp"}}');var r=t(74848),i=t(28453);const s={title:"Build an AI agent",description:"A quickstart guide to building a simple AI agent on Linea.",image:"/img/socialCards/build-an-ai-agent.jpg"},o=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"1. Set up the environment",id:"1-set-up-the-environment",level:2},{value:"2. Configure the AI agent for Linea",id:"2-configure-the-ai-agent-for-linea",level:2},{value:"Set up the <code>.env</code> file",id:"set-up-the-env-file",level:3},{value:"Install the EVM plugin",id:"install-the-evm-plugin",level:3},{value:"3. How it works",id:"3-how-it-works",level:2},{value:"Actions files",id:"actions-files",level:3},{value:"Contracts artifacts and sources",id:"contracts-artifacts-and-sources",level:3},{value:"Providers",id:"providers",level:3},{value:"Templates",id:"templates",level:3},{value:"4. Run the AI agent",id:"4-run-the-ai-agent",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["ElizaOS is an open-source framework for creating AI agents that interact with blockchain networks. This tutorial will guide you through setting up an AI agent on the ",(0,r.jsx)(n.strong,{children:"Linea blockchain"})," using ElizaOS. By the end, your agent will be able to execute smart contract transactions and interact with the blockchain autonomously. You\u2019ll be able to add any custom action to improve it and make it the best agent in town."]}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Install ",(0,r.jsx)(n.a,{href:"https://nodejs.org/",children:"Node.js"})," (23.3) and ",(0,r.jsx)(n.a,{href:"https://pnpm.io/",children:"pnpm"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Basic knowledge of ",(0,r.jsx)(n.strong,{children:"TypeScript"})," and ",(0,r.jsx)(n.strong,{children:"blockchain concepts"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Access to a Linea RPC endpoint and a funded Ethereum wallet for testing. We strongly recommend you use a development wallet. Stay safe!"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-set-up-the-environment",children:"1. Set up the environment"}),"\n",(0,r.jsx)(n.p,{children:"To start, we want to clone the main ElizaOS repo, there\u2019s also a starter-kit if you prefer but I recommend you to use the full package:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/elizaOS/eliza.git # Starter kit: eliza-starter.git\ncd eliza # Starter kit : eliza-starter\n"})}),"\n",(0,r.jsx)(n.p,{children:"This sets up the framework on your local machine. ElizaOS is iterating fast, so a few things might have changed if you\u2019re following this tutorial a long time after its publication."}),"\n",(0,r.jsx)(n.p,{children:"Be sure you\u2019re using the right version of Node. If you get an error message, it can help to to start again with a clean Node modules installation."}),"\n",(0,r.jsx)(n.p,{children:"Then, you need to checkout to the latest version of ElizaOS:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git checkout $(git describe --tags --abbrev=0)\n# If the above doesn't checkout the latest release, this should work:\n# git checkout $(git describe --tags `git rev-list --tags --max-count=1`)\n\npnpm install\n"})}),"\n",(0,r.jsx)(n.p,{children:"Installation can take time, so relax and go grab a drink \u2615"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-configure-the-ai-agent-for-linea",children:"2. Configure the AI agent for Linea"}),"\n",(0,r.jsxs)(n.p,{children:["ElizaOS uses environment variables stored in a ",(0,r.jsx)(n.code,{children:".env"})," file to manage configurations, including blockchain settings."]}),"\n",(0,r.jsxs)(n.h3,{id:"set-up-the-env-file",children:["Set up the ",(0,r.jsx)(n.code,{children:".env"})," file"]}),"\n",(0,r.jsxs)(n.p,{children:["Copy the ",(0,r.jsx)(n.code,{children:".env.example"})," file in a ",(0,r.jsx)(n.code,{children:".env"})," file in the root directory and configure it as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Blockchain Connection\nEVM_RPC_URL=https://rpc.linea.build\nEVM_PRIVATE_KEY=your_private_key_here\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"your_private_key_here"})," with your Ethereum ",(0,r.jsx)(n.strong,{children:"development"})," private key. Be sure to keep this key private and do not reuse it to store funds."]}),"\n",(0,r.jsxs)(n.p,{children:["We\u2019ll also need a ",(0,r.jsx)(n.code,{children:"modelProvider"})," (unless you feel comfortable running a local model on your computer; it can be quite slow depending on your computer's performance). You can add your API key in the ",(0,r.jsx)(n.code,{children:".env"})," file, depending on which provider you\u2019ll use (OpenAI, Anthropic, Gaia, etc.). Some ",(0,r.jsx)(n.code,{children:"modelProvider"}),"s provide different options, such as enabling you to choose a specific model for certain actions."]}),"\n",(0,r.jsx)(n.h3,{id:"install-the-evm-plugin",children:"Install the EVM plugin"}),"\n",(0,r.jsxs)(n.p,{children:["We\u2019ll use the ",(0,r.jsx)(n.a,{href:"https://github.com/elizaOS/eliza/tree/main/packages/plugin-evm",children:"EVM Plugin"})," to interact with the Linea blockchain."]}),"\n",(0,r.jsx)(n.p,{children:"If you used the main repository, it should already be installed, otherwise, you need to install it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm add @elizaos/plugin-evm\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then, configure the plugin in your character settings."}),"\n",(0,r.jsx)(n.p,{children:"ElizaOS uses some \u201ccharacters\u201d files that define your agent's personality. You can create one or choose a preconfigured one in the characters folder."}),"\n",(0,r.jsx)(n.p,{children:"At the top of the file, you'll need to add the following:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n\t...,\n\t"modelProvider": "your_provider_name", //eg. openai\n\t"settings": {\n\t\t"chains": {\n\t\t\t"evm": [ "lineaSepolia" ]\n\t\t}\n\t},\n\t"plugins": ["@elizaos/plugin-evm"],\n\t...\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"This will allow you to use all the actions in the EVM plugin and configure your AI agent to use your provider."}),"\n",(0,r.jsx)(n.h2,{id:"3-how-it-works",children:"3. How it works"}),"\n",(0,r.jsxs)(n.p,{children:["If you check the ",(0,r.jsx)(n.code,{children:"/plugin-evm"})," folder, you\u2019ll see different types of files:"]}),"\n",(0,r.jsx)(n.h3,{id:"actions-files",children:"Actions files"}),"\n",(0,r.jsx)(n.p,{children:"They define actions that can be performed by the agent."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",metastring:'title="actions/transfer.ts"',children:'import { type ByteArray, formatEther, parseEther, type Hex } from "viem";\nimport {\n    type Action,\n    composeContext,\n    generateObjectDeprecated,\n    type HandlerCallback,\n    ModelClass,\n    type IAgentRuntime,\n    type Memory,\n    type State,\n} from "@elizaos/core";\n\nimport { initWalletProvider, type WalletProvider } from "../providers/wallet";\nimport type { Transaction, TransferParams } from "../types";\nimport { transferTemplate } from "../templates";\n\n// Exported for tests\nexport class TransferAction {\n    constructor(private walletProvider: WalletProvider) {}\n\n    async transfer(params: TransferParams): Promise<Transaction> {\n        console.log(\n            `Transferring: ${params.amount} tokens to (${params.toAddress} on ${params.fromChain})`\n        );\n\n        if (!params.data) {\n            params.data = "0x";\n        }\n\n        this.walletProvider.switchChain(params.fromChain);\n\n        const walletClient = this.walletProvider.getWalletClient(\n            params.fromChain\n        );\n\n        try {\n            const hash = await walletClient.sendTransaction({\n                account: walletClient.account,\n                to: params.toAddress,\n                value: parseEther(params.amount),\n                data: params.data as Hex,\n                kzg: {\n                    blobToKzgCommitment: (_: ByteArray): ByteArray => {\n                        throw new Error("Function not implemented.");\n                    },\n                    computeBlobKzgProof: (\n                        _blob: ByteArray,\n                        _commitment: ByteArray\n                    ): ByteArray => {\n                        throw new Error("Function not implemented.");\n                    },\n                },\n                chain: undefined,\n            });\n\n            return {\n                hash,\n                from: walletClient.account.address,\n                to: params.toAddress,\n                value: parseEther(params.amount),\n                data: params.data as Hex,\n            };\n        } catch (error) {\n            throw new Error(`Transfer failed: ${error.message}`);\n        }\n    }\n}\n\nconst buildTransferDetails = async (\n    state: State,\n    runtime: IAgentRuntime,\n    wp: WalletProvider\n): Promise<TransferParams> => {\n    const chains = Object.keys(wp.chains);\n    state.supportedChains = chains.map((item) => `"${item}"`).join("|");\n\n    const context = composeContext({\n        state,\n        template: transferTemplate,\n    });\n\n    const transferDetails = (await generateObjectDeprecated({\n        runtime,\n        context,\n        modelClass: ModelClass.SMALL,\n    })) as TransferParams;\n\n    const existingChain = wp.chains[transferDetails.fromChain];\n\n    if (!existingChain) {\n        throw new Error(\n            "The chain " +\n                transferDetails.fromChain +\n                " not configured yet. Add the chain or choose one from configured: " +\n                chains.toString()\n        );\n    }\n\n    return transferDetails;\n};\n\nexport const transferAction: Action = {\n    name: "transfer",\n    description: "Transfer tokens between addresses on the same chain",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        _options: any,\n        callback?: HandlerCallback\n    ) => {\n        if (!state) {\n            state = (await runtime.composeState(message)) as State;\n        } else {\n            state = await runtime.updateRecentMessageState(state);\n        }\n\n        console.log("Transfer action handler called");\n        const walletProvider = await initWalletProvider(runtime);\n        const action = new TransferAction(walletProvider);\n\n        // Compose transfer context\n        const paramOptions = await buildTransferDetails(\n            state,\n            runtime,\n            walletProvider\n        );\n\n        try {\n            const transferResp = await action.transfer(paramOptions);\n            if (callback) {\n                callback({\n                    text: `Successfully transferred ${paramOptions.amount} tokens to ${paramOptions.toAddress}\\nTransaction Hash: ${transferResp.hash}`,\n                    content: {\n                        success: true,\n                        hash: transferResp.hash,\n                        amount: formatEther(transferResp.value),\n                        recipient: transferResp.to,\n                        chain: paramOptions.fromChain,\n                    },\n                });\n            }\n            return true;\n        } catch (error) {\n            console.error("Error during token transfer:", error);\n            if (callback) {\n                callback({\n                    text: `Error transferring tokens: ${error.message}`,\n                    content: { error: error.message },\n                });\n            }\n            return false;\n        }\n    },\n    validate: async (runtime: IAgentRuntime) => {\n        const privateKey = runtime.getSetting("EVM_PRIVATE_KEY");\n        return typeof privateKey === "string" && privateKey.startsWith("0x");\n    },\n    examples: [\n        [\n            {\n                user: "assistant",\n                content: {\n                    text: "I\'ll help you transfer 1 ETH to 0x9FA746b844747f77c6C54F4f88ab71048c608864",\n                    action: "SEND_TOKENS",\n                },\n            },\n            {\n                user: "user",\n                content: {\n                    text: "Transfer 1 ETH to 0x9FA746b844747f77c6C54F4f88ab71048c608864",\n                    action: "SEND_TOKENS",\n                },\n            },\n        ],\n    ],\n    similes: ["SEND_TOKENS", "TOKEN_TRANSFER", "MOVE_TOKENS"],\n};\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"contracts-artifacts-and-sources",children:"Contracts artifacts and sources"}),"\n",(0,r.jsx)(n.p,{children:"If you want to allow your agent to deploy new contracts or interact with existing contracts, you can put them in this folder to be able to refer to the ABI in your actions files."}),"\n",(0,r.jsx)(n.h3,{id:"providers",children:"Providers"}),"\n",(0,r.jsx)(n.p,{children:"Contains wallet providers files. You can modify these to use AA wallets, for example, or connect your agent with an MPC provider."}),"\n",(0,r.jsx)(n.h3,{id:"templates",children:"Templates"}),"\n",(0,r.jsx)(n.p,{children:"A very important section: every time you send a prompt to the agent, it\u2019ll try to determine if you\u2019re trying to perform an action, then use the template for this action."}),"\n",(0,r.jsx)(n.p,{children:"Here's the transfer template:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'export const transferTemplate = `You are an AI assistant specialized in processing cryptocurrency transfer requests. Your task is to extract specific information from user messages and format it into a structured JSON response.\n\nFirst, review the recent messages from the conversation:\n\n<recent_messages>\n{{recentMessages}}\n</recent_messages>\n\nHere\'s a list of supported chains:\n<supported_chains>\n{{supportedChains}}\n</supported_chains>\n\nYour goal is to extract the following information about the requested transfer:\n1. Chain to execute on (must be one of the supported chains)\n2. Amount to transfer (in ETH, without the coin symbol)\n3. Recipient address (must be a valid Ethereum address)\n4. Token symbol or address (if not a native token transfer)\n\nBefore providing the final JSON output, show your reasoning process inside <analysis> tags. Follow these steps:\n\n1. Identify the relevant information from the user\'s message:\n   - Quote the part of the message mentioning the chain.\n   - Quote the part mentioning the amount.\n   - Quote the part mentioning the recipient address.\n   - Quote the part mentioning the token (if any).\n\n2. Validate each piece of information:\n   - Chain: List all supported chains and check if the mentioned chain is in the list.\n   - Amount: Attempt to convert the amount to a number to verify it\'s valid.\n   - Address: Check that it starts with "0x" and count the number of characters (should be 42).\n   - Token: Note whether it\'s a native transfer or if a specific token is mentioned.\n\n3. If any information is missing or invalid, prepare an appropriate error message.\n\n4. If all information is valid, summarize your findings.\n\n5. Prepare the JSON structure based on your analysis.\n\nAfter your analysis, provide the final output in a JSON markdown block. All fields except \'token\' are required. The JSON should have this structure:\n\n\\`\\`\\`json\n{\n    "fromChain": string,\n    "amount": string,\n    "toAddress": string,\n    "token": string | null\n}\n\\`\\`\\`\n\nRemember:\n- The chain name must be a string and must exactly match one of the supported chains.\n- The amount should be a string representing the number without any currency symbol.\n- The recipient address must be a valid Ethereum address starting with "0x".\n- If no specific token is mentioned (i.e., it\'s a native token transfer), set the "token" field to null.\n\nNow, process the user\'s request and provide your response.\n`;\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-run-the-ai-agent",children:"4. Run the AI agent"}),"\n",(0,r.jsx)(n.p,{children:"Start the agent with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'pnpm build\npnpm start --character-"characters/yourcharactername.character.json"\n'})}),"\n",(0,r.jsx)(n.p,{children:"You\u2019ll also want to start the web interface, so you can chat with your agent:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm start:client\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The interface is available by default on ",(0,r.jsx)(n.code,{children:"localhost:5173"}),". If you want to interact with multiple agents, launch them on different ports."]}),"\n",(0,r.jsx)(n.p,{children:"And you\u2019re good to go!"}),"\n",(0,r.jsx)(n.p,{children:"You can ask your agent to send some ETH to another address or bridge a token from one chain to another (though for that, you\u2019ll need to add more chains in your configuration). By default, the agent will need the exact name of the chain, e.g.:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Send 1 ETH to 0x9FA746b844747f77c6C54F4f88ab71048c608864 on lineaSepolia\n"})}),"\n",(0,r.jsx)(n.p,{children:"You can modify this by changing the templates in the EVM plugin."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"In this introductory tutorial, you learned how to use ElizaOS to create an AI agent that is able to send transactions on Linea and interact with contracts."}),"\n",(0,r.jsx)(n.p,{children:"There\u2019s much much more you can do with ElizaOS. The framework is evolving very fast, so be ready to devote plenty of time if you plan to explore it further."}),"\n",(0,r.jsxs)(n.p,{children:["For more details, explore the ",(0,r.jsx)(n.a,{href:"https://github.com/elizaOS/eliza",children:"ElizaOS documentation"}),". Happy building!"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var a=t(96540);const r={},i=a.createContext(r);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);