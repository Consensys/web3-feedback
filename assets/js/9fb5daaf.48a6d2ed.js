"use strict";(self.webpackChunkweb3_feedback=self.webpackChunkweb3_feedback||[]).push([[417],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var t=s(96540);const o={},i=t.createContext(o);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},57602:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"get-started/how-to/deploy-subdomain","title":"Deploy a Linea subdomain","description":"Guide to deploy a subdomain for any L1 .eth domain on Linea","source":"@site/docs/get-started/how-to/deploy-subdomain.mdx","sourceDirName":"get-started/how-to","slug":"/get-started/how-to/deploy-subdomain","permalink":"/web3-feedback/get-started/how-to/deploy-subdomain","draft":false,"unlisted":false,"editUrl":"https://github.com/Consensys/doc.linea/tree/main/docs/get-started/how-to/deploy-subdomain.mdx","tags":[],"version":"current","lastUpdatedBy":"Joel Willmore","lastUpdatedAt":1746005489000,"frontMatter":{"title":"Deploy a Linea subdomain","description":"Guide to deploy a subdomain for any L1 .eth domain on Linea","image":"/img/socialCards/deploy-a-linea-subdomain.jpg"},"sidebar":"getStartedSidebar","previous":{"title":"Create a multi-signature smart contract wallet","permalink":"/web3-feedback/get-started/how-to/linea-safe"},"next":{"title":"Retrieve finalized L2 blocks","permalink":"/web3-feedback/get-started/how-to/finalized-block"}}');var o=s(74848),i=s(28453);const a={title:"Deploy a Linea subdomain",description:"Guide to deploy a subdomain for any L1 .eth domain on Linea",image:"/img/socialCards/deploy-a-linea-subdomain.jpg"},r=void 0,d={},l=[{value:"Requirements",id:"requirements",level:2},{value:"Available deployment methods",id:"available-deployment-methods",level:2},{value:"Use the same approach as <code>linea.eth</code>",id:"use-the-same-approach-as-lineaeth",level:3},{value:"Deploy registrar contracts only",id:"deploy-registrar-contracts-only",level:3},{value:"Use ENS contracts",id:"use-ens-contracts",level:3},{value:"Steps",id:"steps",level:2},{value:"1. Deploy subdomain contracts",id:"1-deploy-subdomain-contracts",level:3},{value:"2. Set the Linea target resolution",id:"2-set-the-linea-target-resolution",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["This guide is for developers who want to manage subdomains on Linea for domains they own\non ",(0,o.jsx)(n.a,{href:"https://app.ens.domains/",children:"L1 ENS"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, if you own the domain ",(0,o.jsx)(n.code,{children:"example.eth"})," on L1, you can create and manage subdomains like\n",(0,o.jsx)(n.code,{children:"sub.example.eth"})," on Linea that resolves to the L1 domain, ensuring seamless integration and resolution\nacross both layers."]}),"\n",(0,o.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-contracts",children:"L2 contracts"}),":\nThese Linea contracts handle all operations on your subdomains, including registrations and setting records."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-resolver",children:"L1 contracts"}),":\nThese contracts enable subdomains created on Linea to resolve on L1. You can reuse the\nexisting Linea contracts, unless you require customizations."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["User interface (UI): The UI for managing subdomains; you can adapt the ",(0,o.jsx)(n.a,{href:"https://names.linea.build/",children:"Linea Names app"}),"\nin the ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-app",children:"Linea Names GitHub repository"}),".\nIf you decide to deploy this UI, you will also need to deploy the\n",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-subgraph",children:"Linea Names Subgraph"}),", and\ninclude your own values into the ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/blob/main/packages/linea-ens-subgraph/src/env.ts",children:(0,o.jsx)(n.code,{children:"env.ts"})}),"\nfile."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["Follow the ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-app#quick-start-on-localhost",children:"quickstart guide"}),"\nto test it locally. Replace the environment variables ",(0,o.jsx)(n.code,{children:"BASE_DOMAIN"}),", ",(0,o.jsx)(n.code,{children:"BASE_NODE"}),", ",(0,o.jsx)(n.code,{children:"BASE_LABEL"}),", and\n",(0,o.jsx)(n.code,{children:"BASE_LABEL_HASH"})," in the ",(0,o.jsx)(n.code,{children:".env"})," files (",(0,o.jsx)(n.code,{children:".env.example"})," and ",(0,o.jsx)(n.code,{children:"env.ts"}),") with the values matching your ENS domain."]})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"available-deployment-methods",children:"Available deployment methods"}),"\n",(0,o.jsx)(n.p,{children:"Use one of the following deployment methods to deploy your subdomain."}),"\n",(0,o.jsxs)(n.h3,{id:"use-the-same-approach-as-lineaeth",children:["Use the same approach as ",(0,o.jsx)(n.code,{children:"linea.eth"})]}),"\n",(0,o.jsxs)(n.p,{children:["Manage your subdomains the same way ",(0,o.jsx)(n.code,{children:"linea.eth"})," subdomains are managed using the deployment ",(0,o.jsx)(n.a,{href:"#steps",children:"steps below"}),".\nThis includes using the Proof of Humanity (PoH) check for registering subdomains."]}),"\n",(0,o.jsx)(n.h3,{id:"deploy-registrar-contracts-only",children:"Deploy registrar contracts only"}),"\n",(0,o.jsxs)(n.p,{children:["Deploy only your ",(0,o.jsx)(n.code,{children:"Registrar"})," contracts while using the same ",(0,o.jsx)(n.code,{children:"Registry"})," and ",(0,o.jsx)(n.code,{children:"Resolver"})," contract\naddresses deployed for the ",(0,o.jsx)(n.code,{children:"linea.eth"})," subdomain. Contact ",(0,o.jsx)(n.a,{href:"https://support.linea.build/",children:"Linea Support"}),"\nto gain ownership of an L1 domain on Linea. This solution allows you to deploy only the registrar contracts."]}),"\n",(0,o.jsx)(n.h3,{id:"use-ens-contracts",children:"Use ENS contracts"}),"\n",(0,o.jsxs)(n.p,{children:["Modify the ",(0,o.jsx)(n.a,{href:"https://github.com/ensdomains/ens-contracts",children:"original ENS contracts deployed on Ethereum Mainnet"}),".\nYou must modify the node managed by the Registrar contract to match your domain's node."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, for ",(0,o.jsx)(n.code,{children:"linea.eth"}),", we set the node in the ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/blob/49c1bd707467daa3a77d06592e2523d74825bdfb/packages/linea-ens-contracts/contracts/ethregistrar/ETHRegistrarController.sol#L162",children:"contract's constructor"}),"."]}),"\n",(0,o.jsxs)(n.admonition,{type:"warning",children:[(0,o.jsx)(n.mdxAdmonitionTitle,{}),(0,o.jsxs)(n.p,{children:["If you modify the ",(0,o.jsx)(n.code,{children:"PublicResolver"})," contract and it impacts storage, you must deploy your own\n",(0,o.jsx)(n.code,{children:"L1Resolver"})," contract on L1 to match those modifications, as the ",(0,o.jsx)(n.code,{children:"L1Resolver"})," uses hard-coded\nstorage slots (as seen ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens/blob/1b896c9f6f77c6258926957af370bb3d692f540a/packages/linea-ens-resolver/contracts/L1Resolver.sol#L36",children:"here"}),")."]})]}),"\n",(0,o.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,o.jsxs)(n.p,{children:["The following steps show how to deploy and configure subdomain contracts on Linea in the same way that\nthey were used to create the ",(0,o.jsx)(n.code,{children:"linea.eth"})," subdomain."]}),"\n",(0,o.jsx)(n.h3,{id:"1-deploy-subdomain-contracts",children:"1. Deploy subdomain contracts"}),"\n",(0,o.jsx)(n.p,{children:"Deploy the subdomain contracts on the Linea network:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Clone the ",(0,o.jsx)(n.a,{href:"https://github.com/Consensys/linea-ens",children:"Linea Names repository"})," and execute the\nfollowing commands:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd ./packages/linea-ens-contracts\nyarn\ncp .env.org .env\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Replace the following keys in the ",(0,o.jsx)(n.code,{children:".env"})," file with your own information:"]}),"\n",(0,o.jsx)(n.admonition,{type:"danger",children:(0,o.jsxs)(n.p,{children:["Do not commit the ",(0,o.jsx)(n.code,{children:".env"})," file to your repository if it contains sensitive data. You can\ncreate a ",(0,o.jsx)(n.code,{children:".gitignore"})," file to prevent accidentally committing the file."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"DEPLOYER_PRIVATE_KEY=\nOWNER_PRIVATE_KEY=\nINFURA_API_KEY=\nBASE_DOMAIN=\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["Replace ",(0,o.jsx)(n.code,{children:"BASE_DOMAIN"})," environment variable with the L1 ENS domain you own. For example, for ",(0,o.jsx)(n.code,{children:"linea.eth"}),",\nit's ",(0,o.jsx)(n.code,{children:"linea"}),"."]})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Deploy the contract:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"yarn hardhat deploy --network lineaMainnet\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Copy the ",(0,o.jsx)(n.code,{children:"PublicResolver"})," contract address from the ",(0,o.jsx)(n.code,{children:"./deployments/lineaMainnet/PublicResolver.json"}),"\nfile:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'"address": "0x86c5AED9F27837074612288610fB98ccC1733126",\n'})}),"\n",(0,o.jsx)(n.p,{children:"Copy this address \u2014 you'll need it in the next step."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["The contracts to manage your subdomains on Linea have now been deployed. The next step is to link\nthese subdomains to your L1 domain on L1 for ",(0,o.jsx)(n.a,{href:"/web3-feedback/get-started/tooling/cross-chain/ccip-read",children:"CCIP resolution"})," to work."]}),"\n",(0,o.jsx)(n.h3,{id:"2-set-the-linea-target-resolution",children:"2. Set the Linea target resolution"}),"\n",(0,o.jsx)(n.p,{children:"Set the Linea target resolution on the L1 ENS domain:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Retrieve the DNS encoded name for your ENS domain by running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"ts-node scripts/getENSHashes.ts yourdomain.eth\n"})}),"\n",(0,o.jsxs)(n.p,{children:["For example, ",(0,o.jsx)(n.code,{children:"ts-node scripts/getENSHashes.ts linea.eth"})]}),"\n",(0,o.jsx)(n.p,{children:"Example output:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"The namehash of 'linea.eth' is: 0x527aac89ac1d1de5dd84cff89ec92c69b028ce9ce3fa3d654882474ab4402ec3\nThe DNS encoded name of 'linea.eth' is: 0x056c696e65610365746800\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Keep the DNS encoded name result, for example ",(0,o.jsx)(n.code,{children:"0x056c696e65610365746800"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Go to the ",(0,o.jsx)(n.a,{href:"https://etherscan.io/address/0xde16ee87B0C019499cEBDde29c9F7686560f679a#writeContract",children:"Linea Custom Resolver contract on Etherscan"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.strong,{children:"Write Contract"})," tab, connect your wallet using the ",(0,o.jsx)(n.strong,{children:"Connect with web3"})," button.\nMake sure to connect with the wallet containing the account that owns your L1 ENS domain.\nIn the ",(0,o.jsx)(n.code,{children:"setTarget"})," function add the following parameters:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"name"}),": The DNS encoded name you got from step 1."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"target"}),": The Linea resolver target address you copied from the ",(0,o.jsx)(n.code,{children:"PublicResolver.json"})," file\nin the previous step."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Then select ",(0,o.jsx)(n.strong,{children:"Write"})," and approve the transaction."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Go to the ",(0,o.jsx)(n.a,{href:"https://app.ens.domains/",children:"ENS app"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Search for your ENS domain and go to the profile page."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Select the ",(0,o.jsx)(n.strong,{children:"More"})," tab, and in the ",(0,o.jsx)(n.strong,{children:"Resolver"})," section select ",(0,o.jsx)(n.strong,{children:"Edit"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Select ",(0,o.jsx)(n.strong,{children:"Custom Resolver"})," and add the address ",(0,o.jsx)(n.code,{children:"0xde16ee87B0C019499cEBDde29c9F7686560f679a"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Select ",(0,o.jsx)(n.strong,{children:"Update"})," and approve the transaction."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["The setup to manage subdomains on Linea for your ENS domain is now complete and configured\nsimilarly to ",(0,o.jsx)(n.code,{children:"linea.eth"}),". This means anyone with an active PoH on Linea can now register a\n",(0,o.jsx)(n.code,{children:"subdomain.yourdomain.eth"})," that will be resolved on the L1 ENS."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);