"use strict";(self.webpackChunkweb3_feedback=self.webpackChunkweb3_feedback||[]).push([[4668],{28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var a=n(96540);const s={},r=a.createContext(s);function i(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:t},e.children)}},30371:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"get-started/how-to/gas-fees","title":"Estimate transaction costs","description":"How to estimate Linea gas costs","source":"@site/docs/get-started/how-to/gas-fees.mdx","sourceDirName":"get-started/how-to","slug":"/get-started/how-to/gas-fees","permalink":"/web3-feedback/get-started/how-to/gas-fees","draft":false,"unlisted":false,"editUrl":"https://github.com/Consensys/doc.linea/tree/main/docs/get-started/how-to/gas-fees.mdx","tags":[],"version":"current","lastUpdatedBy":"Joel Willmore","lastUpdatedAt":1744797916000,"sidebarPosition":6,"frontMatter":{"description":"How to estimate Linea gas costs","sidebar_position":6,"image":"/img/socialCards/how-to-estimate-linea-gas-costs.jpg"},"sidebar":"getStartedSidebar","previous":{"title":"Connect a wallet to your dapp","permalink":"/web3-feedback/get-started/how-to/connect-wallet"},"next":{"title":"Bridge your tokens","permalink":"/web3-feedback/get-started/how-to/bridge/"}}');var s=n(74848),r=n(28453);n(65537),n(79329);const i={description:"How to estimate Linea gas costs",sidebar_position:6,image:"/img/socialCards/how-to-estimate-linea-gas-costs.jpg"},o="Estimate transaction costs",l={},c=[{value:"How gas works on Linea",id:"how-gas-works-on-linea",level:2},{value:"Gas pricing",id:"gas-pricing",level:2},{value:"<code>linea_estimateGas</code>",id:"linea_estimategas",level:2},{value:"Example",id:"example",level:3},{value:"Request",id:"request",level:4},{value:"Response",id:"response",level:4}];function d(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"estimate-transaction-costs",children:"Estimate transaction costs"})}),"\n",(0,s.jsx)(t.h2,{id:"how-gas-works-on-linea",children:"How gas works on Linea"}),"\n",(0,s.jsxs)(t.p,{children:["Linea supports the ",(0,s.jsx)(t.a,{href:"https://ethereum.org/developers/docs/gas",children:"Ethereum EIP-1559 gas price model"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"total fee = units of gas used * (base fee + priority fee)\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Linea fundamentally works exactly the same as Ethereum. The only difference is that ",(0,s.jsx)(t.strong,{children:"the base fee\nis constant at 7 wei."})," Blocks created by Linea use up to 24 million gas (less than 50% of the\nmaximum Linea block size of 61 million gas), and the fee decreases by 12.5% per block, keeping it\nat a stable 7 wei."]}),"\n",(0,s.jsx)(t.p,{children:"The gas cost to submit your transaction and include it on Ethereum involves the following fee\ncomponents:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Layer 2 cost"}),": The execution fee; the cost of including your transaction on the Linea\nsequencer, and calculated using a similar formula to Ethereum (as described above)."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Layer 1 cost"}),": The cost of publishing your L2 transaction on Ethereum, which varies\nbased on the blob fee market."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"These two resource costs are abstracted by the rollup and covered by the recommended L2 gas price\nand gas used."}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["Learn more about gas on Linea on our ",(0,s.jsx)(t.a,{href:"https://support.linea.build/getting-started/what-does-gas-pay-for",children:"support page"}),"\nand release notes for ",(0,s.jsx)(t.a,{href:"/web3-feedback/release-notes#alpha-v2",children:"Alpha v2"})," and ",(0,s.jsx)(t.a,{href:"/web3-feedback/release-notes#alpha-v3",children:"Alpha v3"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"linea_estimateGas"})," is the recommended method for estimating gas on Linea. See our\n",(0,s.jsx)(t.a,{href:"/web3-feedback/api/reference/linea-estimategas",children:"reference page"})," for more information."]}),"\n",(0,s.jsx)(t.p,{children:"Linea also supports:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://docs.infura.io/api/networks/linea/json-rpc-methods/eth_estimategas",children:(0,s.jsx)(t.code,{children:"eth_estimateGas"})})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://docs.infura.io/api/networks/linea/json-rpc-methods/eth_gasprice",children:(0,s.jsx)(t.code,{children:"eth_gasPrice"})})}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"https://docs.infura.io/api/networks/linea/json-rpc-methods/eth_feehistory",children:(0,s.jsx)(t.code,{children:"eth_feeHistory"})}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"gas-pricing",children:"Gas pricing"}),"\n",(0,s.jsxs)(t.p,{children:["The gas price returned by ",(0,s.jsx)(t.code,{children:"linea_estimateGas"})," is based on the variable data cost of the previous\nblock with a multiplier applied as a buffer to ensure inclusion."]}),"\n",(0,s.jsxs)(t.p,{children:["Each Linea block's ",(0,s.jsx)(t.code,{children:"extraData"})," field is populated with the following gas price values that are used\nby ",(0,s.jsx)(t.code,{children:"linea_estimateGas"})," to calculate the cost of a transaction:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"FIXED_COST"})," of 0.03 Gwei, which reflects infrastructure costs;"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"VARIABLE_COST"}),", which is the cost per byte of data submitted to L1, and;"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"ETH_GAS_PRICE"}),", used to set a more accurate return value for any ",(0,s.jsx)(t.code,{children:"eth_gasPrice"})," calls."]}),"\n"]}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"extraData"})," field is a 32-byte space used to store arbitrary data, such as metadata or\nadditional information relevant to the block."]}),(0,s.jsxs)(t.p,{children:["On Linea, it's used by the sequencer and Linea Besu nodes running the correct plugins to expose\n",(0,s.jsx)(t.code,{children:"linea_estimateGas"}),"."]})]}),"\n",(0,s.jsx)(t.p,{children:"Variable cost is calculated with the following formula:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"VARIABLE_COST (4 bytes) = min(max(\n(\n  (\n    ((averageWeightedBaseFee + averageWeightedPriorityFee) * \n    blob-submission-expected-execution-gas + averageWeightedBlobBaseFee * expected-blob-gas\n  ) / bytes-per-data-submission) * profit-margin\n)\n, min-bound), max-bound)\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"profit-margin"})," ensures the network is sustainable. ",(0,s.jsx)(t.code,{children:"min-bound"})," and ",(0,s.jsx)(t.code,{children:"max-bound"})," are variable,\nand guarantee the gas price stays within a reasonable range."]}),"\n",(0,s.jsxs)(t.p,{children:["The variable cost formula enables ",(0,s.jsx)(t.code,{children:"linea_estimateGas"})," to price according to the variable costs of\nsubmitting blob data to L1, working out the per-byte cost of that data. The amount of the blob data\nin each block stays roughly consistent, though the amount ",(0,s.jsx)(t.em,{children:"per transaction"})," varies, so the\n",(0,s.jsx)(t.code,{children:"linea_estimateGas"})," API accounts for this, and ensures a gas price is returned for the transaction\nthat reflects the amount of data it contains. In turn, it ensures that the network is sustainable,\nand that the cost to the protocol of L1 data availability is covered."]}),"\n",(0,s.jsxs)(t.p,{children:["To determine the priority fee per gas, ",(0,s.jsx)(t.code,{children:"linea_estimateGas"})," takes the previous block's ",(0,s.jsx)(t.code,{children:"VARIABLE_COST"}),"\ninto account:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"min-gas-price = previousBlock.extraData.variable_cost\nbaseFeePerGas = vanillaProtocolBaseFee\npriorityFeePerGas = MINIMUM_MARGIN * (min-gas-price * L2_compressed_tx_size_in_bytes / L2_tx_gas_used + extraData.fixed_cost)\n"})}),"\n",(0,s.jsx)(t.p,{children:"Where:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"extraData.variable_cost"})," is where the previous block's ",(0,s.jsx)(t.code,{children:"VARIABLE_COST"})," is stored\nblock"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"MINIMUM_MARGIN"})," varies depending on the stage of the transaction:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["RPC method, i.e. calling ",(0,s.jsx)(t.code,{children:"linea_estimateGas"}),": ",(0,s.jsx)(t.code,{children:"1.2"})]}),"\n",(0,s.jsxs)(t.li,{children:["In the transaction pool: ",(0,s.jsx)(t.code,{children:"0.8"})]}),"\n",(0,s.jsxs)(t.li,{children:["At transaction selection stage: ",(0,s.jsx)(t.code,{children:"1.0"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"The RPC method and transaction pool values are configurable by RPC providers or those running their\nown nodes according to preference; the transaction selection stage value is fixed. For example,\nit may be preferable to set a lower margin to facilitate lower gas prices, but this risks\ntransactions not being included."})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"linea_estimateGas"})," simulates the transaction ordering logic that the sequencer uses when building\nblocks, and then obtains a gas price that will ensure that the priority fee is high enough for\ninclusion. The sequencer's transaction ordering policy includes transactions in block in order of\nhighest priority fee, a system known as a priority gas auction. It also checks that the priority\nfees offered by each transaction are high enough to support network sustainability, and cover L1\ndata costs."]}),"\n",(0,s.jsx)(t.p,{children:"In some cases, transactions with lower priority fees are included ahead of others with higher\npriority fees. This is because the nonce order of transactions submitted from the same account\ntakes precedence."}),"\n",(0,s.jsx)(t.h2,{id:"linea_estimategas",children:(0,s.jsx)(t.a,{href:"/web3-feedback/api/reference/linea-estimategas",children:(0,s.jsx)(t.code,{children:"linea_estimateGas"})})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"linea_estimateGas"})," is the recommended method for estimating gas on Linea. It returns ",(0,s.jsx)(t.code,{children:"gasLimit"}),",\n",(0,s.jsx)(t.code,{children:"baseFeePerGas"}),", and ",(0,s.jsx)(t.code,{children:"priorityFeePerGas"}),", and therefore provides a more precise gas estimate than\nthe alternatives."]}),"\n",(0,s.jsxs)(t.p,{children:["It can also help prevent transactions from being rejected due to exceeding ",(0,s.jsx)(t.a,{href:"/web3-feedback/technology/prover/prover-limits",children:"module limits"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"example",children:"Example"}),"\n",(0,s.jsx)(t.h4,{id:"request",children:"Request"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'curl https://linea-mainnet.infura.io/v3/YOUR-API-KEY \\\n-X POST \\\n-H "Content-Type: application/json" \\\n-d \'{"jsonrpc": "2.0","method": "linea_estimateGas","params": [{"from": "0x971e727e956690b9957be6d51Ec16E73AcAC83A7","gas":"0x21000"}],"id": 53}\'\n'})}),"\n",(0,s.jsx)(t.h4,{id:"response",children:"Response"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'{\n  "jsonrpc": "2.0",\n  "id": 53,\n  "result": {\n    "baseFeePerGas": "0x7",\n    "gasLimit": "0xcf08",\n    "priorityFeePerGas": "0x43a82a4"\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"/web3-feedback/api/reference/linea-estimategas",children:"reference page"})," for full usage."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},65537:(e,t,n)=>{n.d(t,{A:()=>y});var a=n(96540),s=n(34164),r=n(65627),i=n(56347),o=n(50372),l=n(30604),c=n(11861),d=n(78749);function h(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:s}}=e;return{value:t,label:n,attributes:a,default:s}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const s=(0,i.W6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(r),(0,a.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(s.location.search);t.set(r,e),s.replace({...s.location,search:t.toString()})}),[r,s])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,r=u(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:r}))),[c,h]=m({queryString:n,groupId:s}),[f,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,r]=(0,d.Dv)(n);return[s,(0,a.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:s}),g=(()=>{const e=c??f;return p({value:e,tabValues:r})?e:null})();(0,o.A)((()=>{g&&l(g)}),[g]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),b(e)}),[h,b,r]),tabValues:r}}var b=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(74848);function j(e){let{className:t,block:n,selectedValue:a,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),s=o[n].value;s!==a&&(c(t),i(s))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...r,className:(0,s.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:r}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r})))})}function w(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",g.tabList),children:[(0,x.jsx)(j,{...t,...e}),(0,x.jsx)(v,{...t,...e})]})}function y(e){const t=(0,b.A)();return(0,x.jsx)(w,{...e,children:h(e.children)},String(t))}},79329:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var a=n(34164);const s={tabItem:"tabItem_Ymn6"};var r=n(74848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(s.tabItem,i),hidden:n,children:t})}}}]);