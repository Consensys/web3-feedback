"use strict";(self.webpackChunkweb3_feedback=self.webpackChunkweb3_feedback||[]).push([[5432],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var r=t(96540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}},90383:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"learn/marketplace-dapp","title":"Build a marketplace dapp","description":"A step-by-step guide to building a simple marketplace dapp on Linea.","source":"@site/docs/learn/marketplace-dapp.mdx","sourceDirName":"learn","slug":"/learn/marketplace-dapp","permalink":"/web3-feedback/learn/marketplace-dapp","draft":false,"unlisted":false,"editUrl":"https://github.com/Consensys/doc.linea/tree/main/docs/learn/marketplace-dapp.mdx","tags":[],"version":"current","lastUpdatedBy":"oliver renwick","lastUpdatedAt":1742484500000,"frontMatter":{"title":"Build a marketplace dapp","description":"A step-by-step guide to building a simple marketplace dapp on Linea.","image":"/img/socialCards/build-a-marketplace-dapp.jpg"},"sidebar":"learnSidebar","previous":{"title":"Build an AI agent","permalink":"/web3-feedback/learn/aiagent-quickstart"},"next":{"title":"Build a voting dapp","permalink":"/web3-feedback/learn/voting-dapp"}}');var i=t(74848),s=t(28453);const a={title:"Build a marketplace dapp",description:"A step-by-step guide to building a simple marketplace dapp on Linea.",image:"/img/socialCards/build-a-marketplace-dapp.jpg"},c=void 0,l={},o=[{value:"Architecture",id:"architecture",level:2},{value:"Set up the environment",id:"set-up-the-environment",level:3},{value:"Project structure",id:"project-structure",level:3},{value:"Write the smart contract",id:"write-the-smart-contract",level:3},{value:"<code>.env</code> variables",id:"env-variables",level:3},{value:"Deploy the smart contract",id:"deploy-the-smart-contract",level:3},{value:"Frontend: Next.js with Shadcn UI",id:"frontend-nextjs-with-shadcn-ui",level:2},{value:"Create and navigate to the project directory",id:"create-and-navigate-to-the-project-directory",level:3},{value:"Initialize Next.js project",id:"initialize-nextjs-project",level:3},{value:"Install Shadcn UI CLI",id:"install-shadcn-ui-cli",level:3},{value:"React and hooks usage",id:"react-and-hooks-usage",level:2},{value:"State management",id:"state-management",level:2},{value:"<code>useEffect</code> for data loading",id:"useeffect-for-data-loading",level:2},{value:"Smart contract interaction",id:"smart-contract-interaction",level:2},{value:"Writing to the blockchain",id:"writing-to-the-blockchain",level:2},{value:"UI components and styling",id:"ui-components-and-styling",level:2},{value:"Form handling",id:"form-handling",level:2},{value:"Error handling",id:"error-handling",level:2},{value:"Run the development server",id:"run-the-development-server",level:3},{value:"Resources:",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Decentralized marketplaces are one of the most popular types of web3 dapps, and enable users to\nbuy and sell items directly on the blockchain while removing the need for any intermediaries."}),"\n",(0,i.jsx)(n.p,{children:"In this tutorial, we will build a simple marketplace dapp."}),"\n",(0,i.jsxs)(n.p,{children:["We will cover both the ",(0,i.jsx)(n.strong,{children:"frontend"})," and ",(0,i.jsx)(n.strong,{children:"smart contract development."})]}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)(n.p,{children:"Let's dive into the architecture of the marketplace dapp and its components."}),"\n",(0,i.jsx)(n.p,{children:"The marketplace will incorporate smart contracts, a frontend, and blockchain integration. The smart\ncontract will include features such as listing items, buying items, and transferring ownership of\nan item."}),"\n",(0,i.jsx)(n.p,{children:"The frontend serves as the user interface where buyers and sellers can interact with each other\nusing the smart contract. While having a frontend and backend is important, the way the dapp\ninteracts with the Linea blockchain is also crucial. We will be using the MetaMask SDK along with\nWagmi and Infura RPC providers."}),"\n",(0,i.jsx)(n.h3,{id:"set-up-the-environment",children:"Set up the environment"}),"\n",(0,i.jsx)(n.p,{children:"We will start by initializing a monorepo. A monorepo (short for monolithic repository) is a software\ndevelopment strategy where code for multiple projects is stored in a single version control repository."}),"\n",(0,i.jsx)(n.p,{children:"To create our monorepo, we'll use pnpm."}),"\n",(0,i.jsx)(n.p,{children:"Create a new directory for your monorepo and initialize it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"mkdir web3-marketplace-linea\ncd web3-marketplace-linea\npnpm init\n\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"pnpm-workspace.yaml"})," file in the root to define your workspace structure:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"packages:\n  - 'packages/*'\n"})}),"\n",(0,i.jsx)(n.p,{children:"Here's what our workspace file structure will be like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"packages\n\u251c\u2500\u2500 site          # Frontend built with Next.js, Tailwind CSS, and Shadcn UI\n\u2514\u2500\u2500 blockchain    # Smart contracts using Hardhat\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Let's head over to the ",(0,i.jsx)(n.code,{children:"blockchain"})," directory and initialize a Hardhat project."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"cd blockchain\nnpx hardhat init\n"})}),"\n",(0,i.jsx)(n.p,{children:"You'll be presented with several options:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"? What do you want to do? \u2026\n\u276f Create a JavaScript project\n  Create a TypeScript project\n  Create a TypeScript project (with Viem)\n  Create an empty hardhat.config.js\n  Quit\n"})}),"\n",(0,i.jsx)(n.p,{children:"For this tutorial we'll be using a TypeScript project. Hardhat will automatically install the\nnecessary dependencies for you."}),"\n",(0,i.jsx)(n.h3,{id:"project-structure",children:"Project structure"}),"\n",(0,i.jsx)(n.p,{children:"After initialization, you'll have a project structure that includes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"contracts/"})}),": Solidity contracts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ignition/"})}),": Ignition deployment modules"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"test/"})}),": Test files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"hardhat.config.js"})}),": Hardhat configuration"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"write-the-smart-contract",children:"Write the smart contract"}),"\n",(0,i.jsx)(n.p,{children:"Let's start writing the smart contract:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/// @title Marketplace\n/// @notice A simple marketplace contract for listing, purchasing, and transferring items\n/// @dev This contract manages items, their ownership, and transactions\ncontract Marketplace {\n    /// @notice Structure to represent an item in the marketplace\n    /// @dev Each item has a unique ID, name, price, seller, owner, and sale status\n    struct Item {\n        uint id;\n        string name;\n        uint price;\n        address payable seller;\n        address owner;\n        bool isSold;\n    }\n\n    /// @notice Total number of items listed in the marketplace\n    uint public itemCount = 0;\n\n    /// @notice Mapping of item IDs to Item structs\n    mapping(uint => Item) public items;\n\n    /// @notice Mapping of owner addresses to arrays of owned item IDs\n    mapping(address => uint[]) public ownedItems;\n\n    /// @notice Lists a new item in the marketplace\n    /// @param _name The name of the item\n    /// @param _price The price of the item in wei\n    /// @dev Increments itemCount and adds the new item to the items mapping\n    function listItem(string memory _name, uint _price) public {\n        require(_price > 0, "Price must be greater than zero");\n\n        itemCount++;\n        items[itemCount] = Item(itemCount, _name, _price, payable(msg.sender), msg.sender, false);\n        ownedItems[msg.sender].push(itemCount);\n    }\n\n    /// @notice Allows a user to purchase an item\n    /// @param _id The ID of the item to purchase\n    /// @dev Transfers the item\'s price to the seller and updates ownership\n    function purchaseItem(uint _id) public payable {\n        Item storage item = items[_id];\n        require(_id > 0 && _id <= itemCount, "Item does not exist");\n        require(msg.value == item.price, "Incorrect price");\n        require(!item.isSold, "Item already sold");\n        require(msg.sender != item.seller, "Seller cannot buy their own item");\n\n        item.isSold = true;\n        item.seller.transfer(msg.value);\n\n        // Transfer ownership\n        _transferOwnership(_id, item.seller, msg.sender);\n    }\n\n    /// @notice Internal function to transfer ownership of an item\n    /// @param _id The ID of the item\n    /// @param _from The current owner\'s address\n    /// @param _to The new owner\'s address\n    /// @dev Updates the item\'s owner and adjusts the ownedItems mappings\n    function _transferOwnership(uint _id, address _from, address _to) internal {\n        Item storage item = items[_id];\n        item.owner = _to;\n\n        // Remove item from the previous owner\'s list\n        uint[] storage fromItems = ownedItems[_from];\n        for (uint i = 0; i < fromItems.length; i++) {\n            if (fromItems[i] == _id) {\n                fromItems[i] = fromItems[fromItems.length - 1];\n                fromItems.pop();\n                break;\n            }\n        }\n\n        // Add item to the new owner\'s list\n        ownedItems[_to].push(_id);\n    }\n\n    /// @notice Allows the owner to transfer an item to another address\n    /// @param _id The ID of the item to transfer\n    /// @param _to The address of the recipient\n    /// @dev Calls the internal _transferOwnership function\n    function transferItem(uint _id, address _to) public {\n        Item storage item = items[_id];\n        require(_id > 0 && _id <= itemCount, "Item does not exist");\n        require(msg.sender == item.owner, "You do not own this item");\n\n        _transferOwnership(_id, msg.sender, _to);\n    }\n\n    /// @notice Retrieves all item IDs owned by a specific address\n    /// @param _owner The address of the owner\n    /// @return An array of item IDs owned by the specified address\n    function getItemsByOwner(address _owner) public view returns (uint[] memory) {\n        return ownedItems[_owner];\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"This contract provides a basic framework for a decentralized marketplace where users can list items\nfor sale, purchase items, and transfer ownership of items. It maintains a record of item ownership\nand ensures that only valid transactions can occur. Let's explore the concept of the smart contract\na bit more:"}),"\n",(0,i.jsx)("div",{class:"center-container",children:(0,i.jsx)("div",{class:"img-large",children:(0,i.jsx)("img",{src:"/img/marketplace/marketplace-contract.png",alt:""})})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Seller"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Listing an item"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Sellers can list items for sale by calling the ",(0,i.jsx)(n.code,{children:"listItem"})," function."]}),"\n",(0,i.jsx)(n.li,{children:"This function requires a name and price for the item."}),"\n",(0,i.jsx)(n.li,{children:"The item is added to the marketplace with a unique ID, and the seller is recorded as the\nowner."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Buyer"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purchasing an item"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Buyers can purchase items using the ",(0,i.jsx)(n.code,{children:"purchaseItem"})," function."]}),"\n",(0,i.jsx)(n.li,{children:"The function checks that the item exists, the price is correct, and that the item is not\nalready sold."}),"\n",(0,i.jsx)(n.li,{children:"The payment is transferred to the seller, and ownership of the item is updated."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Transferring ownership"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ownership transfer"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"_transferOwnership"})," function handles the internal logic for transferring item ownership."]}),"\n",(0,i.jsxs)(n.li,{children:["It updates the owner in the ",(0,i.jsx)(n.code,{children:"items"})," mapping and adjusts the ",(0,i.jsx)(n.code,{children:"ownedItems"})," lists for both\nthe previous and new owners."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Manual transfer"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"transferItem"})," function allows current owners to transfer their items to another address."]}),"\n",(0,i.jsxs)(n.li,{children:["It ensures the sender is the current owner before calling the ",(0,i.jsx)(n.code,{children:"_transferOwnership"})," function."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Retrieving owned items"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Get items by owner"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"getItemsByOwner"})," function returns a list of item IDs owned by a specific address."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This smart contract facilitates a decentralized marketplace where items can be listed, purchased,\nand transferred securely, with all transactions and ownership changes recorded on the blockchain."}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"ignition"})," folder, let's create ",(0,i.jsx)(n.code,{children:"Marketplace.ts"}),"  to deploy our contract. Add the following code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { buildModule } from "@nomicfoundation/hardhat-ignition/modules";\n\nconst MarketplaceModule = buildModule("MarketplaceModule", (m) => {\n  // Deploy the Marketplace contract\n  const marketplace = m.contract("Marketplace");\n\n  // Return the deployed contract instance\n  return { marketplace };\n});\n\nexport default MarketplaceModule;\n'})}),"\n",(0,i.jsx)(n.p,{children:"To compile the contract, run the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"npx hardhat compile\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"env-variables",children:[(0,i.jsx)(n.code,{children:".env"})," variables"]}),"\n",(0,i.jsxs)(n.p,{children:["Before deploying the smart contract, make sure to update the ",(0,i.jsx)(n.code,{children:".env"})," file in the ",(0,i.jsx)(n.code,{children:"packages/blockchain"}),"\ndirectory with the following values:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Infura API key for connecting to Ethereum networks\nINFURA_API_KEY=your_infura_api_key_here\n\n# Private key of the account to be used for deployments and transactions\nACCOUNT_PRIVATE_KEY=your_account_private_key_here\n"})}),"\n",(0,i.jsx)(n.h3,{id:"deploy-the-smart-contract",children:"Deploy the smart contract"}),"\n",(0,i.jsx)(n.p,{children:"To deploy the smart contract to the Linea testnet, run the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx hardhat ignition deploy ignition/modules/Marketplace.ts --network linea-testnet\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This will deploy the marketplace smart contract on Linea Sepolia. You can always write a script to\ndeploy quicker by writing small commands like this on ",(0,i.jsx)(n.code,{children:"package.json"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'"deploy:testnet": "npx hardhat ignition deploy ignition/modules/Marketplace.ts --network linea-testnet"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["After the deployment we'll get the ",(0,i.jsx)(n.code,{children:"contract address"})," \u2014 make a note of this. We will need it soon\nwhile integrating with the frontend."]}),"\n",(0,i.jsx)(n.h2,{id:"frontend-nextjs-with-shadcn-ui",children:"Frontend: Next.js with Shadcn UI"}),"\n",(0,i.jsx)(n.h3,{id:"create-and-navigate-to-the-project-directory",children:"Create and navigate to the project directory"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir site\ncd site\n"})}),"\n",(0,i.jsx)(n.h3,{id:"initialize-nextjs-project",children:"Initialize Next.js project"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx create-next-app@latest .\n"})}),"\n",(0,i.jsx)(n.p,{children:"When prompted, choose the following options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"TypeScript: Yes"}),"\n",(0,i.jsx)(n.li,{children:"ESLint: Yes"}),"\n",(0,i.jsx)(n.li,{children:"Tailwind CSS: Yes"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"src/"})," directory: No (or Yes, if you prefer)"]}),"\n",(0,i.jsx)(n.li,{children:"App Router: Yes"}),"\n",(0,i.jsx)(n.li,{children:"Import alias: Yes (default @/*)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"install-shadcn-ui-cli",children:"Install Shadcn UI CLI"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx shadcn-ui@latest init\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install the necessary UI components like buttons, cards, and input fields as needed."}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"wagmi.config.ts"})," and add the following code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { http, createConfig } from "wagmi";\nimport { lineaSepolia } from "wagmi/chains";\nimport { metaMask } from "wagmi/connectors";\n\nexport const config = createConfig({\n  chains: [lineaSepolia],\n  connectors: [metaMask()],\n  transports: {\n    [lineaSepolia.id]: http(),\n  },\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["We will be using Wagmi and the MetaMask SDK to connect our wallet and make transactions. All that is\nleft now is to create a ",(0,i.jsx)(n.code,{children:"ConnectWallet.tsx"})," UI component."]}),"\n",(0,i.jsxs)(n.p,{children:["On the ",(0,i.jsx)(n.code,{children:"site/src"})," directory let's create a file called ",(0,i.jsx)(n.code,{children:"constants.ts"})," and add the following:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"export const CONTRACT_ADDRESS = //paste deployed contract here\nexport const ABI = \n  // Paste the ABI here\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Remember the deployed contract address that you saved earlier? We'll add it here. Head over to the\n",(0,i.jsx)(n.code,{children:"blockchain/ignition"})," module and find the ",(0,i.jsx)(n.code,{children:"artifacts"})," folder to find the ABI."]}),"\n",(0,i.jsx)("div",{class:"center-container",children:(0,i.jsx)("div",{class:"img-large",children:(0,i.jsx)("img",{src:"/img/marketplace/marketplace-ui.png",alt:""})})}),"\n",(0,i.jsxs)(n.p,{children:["Let's break down the code in ",(0,i.jsx)(n.code,{children:"app.tsx"})," and explain its key aspects in more detail:"]}),"\n",(0,i.jsx)(n.h2,{id:"react-and-hooks-usage",children:"React and hooks usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { useState, useEffect } from "react";\nimport { useAccount, useWalletClient } from "wagmi";\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The component uses React's ",(0,i.jsx)(n.code,{children:"useState"})," for local state management and ",(0,i.jsx)(n.code,{children:"useEffect"})," for side effects."]}),"\n",(0,i.jsxs)(n.li,{children:["It also uses custom hooks from ",(0,i.jsx)(n.code,{children:"wagmi"})," (",(0,i.jsx)(n.code,{children:"useAccount"})," and ",(0,i.jsx)(n.code,{children:"useWalletClient"}),") for blockchain wallet\nintegration."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"state-management",children:"State management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'const [items, setItems] = useState<any[]>([]);\nconst [ownedItems, setOwnedItems] = useState<any[]>([]);\nconst [newItemName, setNewItemName] = useState("");\nconst [newItemPrice, setNewItemPrice] = useState("");\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Multiple state variables are defined to manage the component's data."}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"items"})," and ",(0,i.jsx)(n.code,{children:"ownedItems"})," are arrays to store marketplace items."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"newItemName"})," and ",(0,i.jsx)(n.code,{children:"newItemPrice"})," are for form inputs when listing a new item."]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"useeffect-for-data-loading",children:[(0,i.jsx)(n.code,{children:"useEffect"})," for data loading"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"useEffect(() => {\n  loadItems();\n  loadOwnedItems();\n}, []);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This effect runs once when the component mounts."}),"\n",(0,i.jsxs)(n.li,{children:["It calls ",(0,i.jsx)(n.code,{children:"loadItems()"})," and ",(0,i.jsx)(n.code,{children:"loadOwnedItems()"})," to populate the state with data from the blockchain."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"smart-contract-interaction",children:"Smart contract interaction"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'const loadItems = async () => {\n  try {\n    const itemCount = await client.readContract({\n      address: CONTRACT_ADDRESS,\n      abi: ABI_STRING_ARRAY,\n      functionName: "itemCount",\n    });\n    // ... (fetching individual items)\n  } catch (error) {\n    console.error("Error loading items:", error);\n  }\n};\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["This function reads data from the smart contract using ",(0,i.jsx)(n.code,{children:"client.readContract"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"It first gets the total item count, then fetches details for each item."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"writing-to-the-blockchain",children:"Writing to the blockchain"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'const listItem = async () => {\n  try {\n    if (!walletClient) return;\n    const { request } = await client.simulateContract({\n      // ... contract call details\n    });\n    await walletClient.writeContract(request);\n    loadItems();\n  } catch (error) {\n    console.error("Error listing item:", error);\n  }\n};\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This function writes data to the blockchain (listing a new item)."}),"\n",(0,i.jsxs)(n.li,{children:["It first simulates the contract call, then uses ",(0,i.jsx)(n.code,{children:"walletClient.writeContract"})," to execute the transaction."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ui-components-and-styling",children:"UI components and styling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'<Card className="p-4 sm:p-6" key={index}>\n  <li key={item.id} className=" p-4">\n    <p><strong>Name:</strong> {item.name}</p>\n    {/* ... other item details */}\n    <Button\n      variant="outline"\n      onClick={() => purchaseItem(item.id, item.price)}\n      className="border-2 border-green-500 text-green-500 hover:bg-green-500 hover:text-white py-2 px-4 rounded  duration-200 hover:shadow-xl"\n    >\n      Purchase\n    </Button>\n  </li>\n</Card>\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The component uses custom UI components like ",(0,i.jsx)(n.code,{children:"Card"})," and ",(0,i.jsx)(n.code,{children:"Button"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Tailwind CSS classes are used for styling (",(0,i.jsx)(n.code,{children:"className"})," props)."]}),"\n",(0,i.jsx)(n.li,{children:"Conditional rendering is used to show/hide the purchase button based on item status and ownership."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"form-handling",children:"Form handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'<Input\n  type="text"\n  placeholder="Item Name"\n  value={newItemName}\n  onChange={(e) => setNewItemName(e.target.value)}\n  className="border p-2 flex-1"\n/>\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Controlled inputs are used for the form fields."}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"value"})," and ",(0,i.jsx)(n.code,{children:"onChange"})," props connect the input to the component's state."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'try {\n  // ... contract interaction\n} catch (error) {\n  console.error("Error loading items:", error);\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Try-catch blocks are used throughout the code to handle potential errors in asynchronous operations,\nespecially during blockchain interactions."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"app.tsx"})," can become quite large so we can also refactor the code in",(0,i.jsx)(n.code,{children:"site/src/app/components/"}),"\ndirectory."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/components\n  - ListItem.tsx\n  - AvailableItems.tsx\n  - OwnedItems.tsx\n/hooks\n  - useItems.ts\n"})}),"\n",(0,i.jsxs)(n.p,{children:["View the ",(0,i.jsx)(n.a,{href:"https://github.com/meowyx/web3-marketplace-linea/blob/code-refactor/packages/site/src/app/page.tsx",children:"full code"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["You can also view the ",(0,i.jsx)(n.a,{href:"https://github.com/meowyx/web3-marketplace-linea/tree/code-refactor/packages/site/src/app",children:"refactored code"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"This component demonstrates advanced React patterns, integration with blockchain technology, and\nmodern UI practices. It showcases how to build a decentralized application frontend that interacts\nwith a smart contract while providing a user-friendly interface."}),"\n",(0,i.jsx)(n.h3,{id:"run-the-development-server",children:"Run the development server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm run dev\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Your Next.js application with Shadcn UI should now be running at ",(0,i.jsx)(n.code,{children:"http://localhost:3000"}),"."]}),"\n",(0,i.jsx)("div",{class:"center-container",children:(0,i.jsx)("div",{class:"img-large",children:(0,i.jsx)("img",{src:"/img/marketplace/marketplace-dapp.png",alt:""})})}),"\n",(0,i.jsx)(n.p,{children:"Now we should be able to list an item, buy and sell, and transfer ownership."}),"\n",(0,i.jsx)(n.p,{children:"In this guide, we built a simple decentralized marketplace DApp on Linea, leveraging zkEVM technology\nfor scalability and cost efficiency. We covered everything from setting up the environment to writing and deploying smart contracts, and integrating the frontend with Next.js and ShadcnUI."}),"\n",(0,i.jsx)(n.p,{children:"Now you have your simple decentralized marketplace dapp! You can explore further options and expand\non this base with enhancements such as optimizing the user experience with additional features, or\nenabling bidding on items, auctions etc. The possibilities of dapps are endless."}),"\n",(0,i.jsx)(n.p,{children:"Happy coding!"}),"\n",(0,i.jsx)(n.h2,{id:"resources",children:"Resources:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["GitHub repository: ",(0,i.jsx)(n.a,{href:"https://github.com/meowyx/web3-marketplace-linea",children:"https://github.com/meowyx/web3-marketplace-linea"})]}),"\n",(0,i.jsxs)(n.li,{children:["Deployed site: ",(0,i.jsx)(n.a,{href:"https://web3-marketplace-linea.vercel.app/",children:"https://web3-marketplace-linea.vercel.app/"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);